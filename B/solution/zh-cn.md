{{ self.title() }}

## 算法1

在修改操作时，维护 $a$ 中每个极长的内部满足 $a_{i+1}=b_{a_i}$ 的段；

对于查询操作，特判跨过 $l$ 或 $r$ 的段，然后查询区间内完整的段；

转化为插入删除竖直线段，查询水平线段经过的竖直线段的最大权值，保证同一时刻竖直线段不相交；

分治后转化为点修改，查区间最大值。

时间复杂度 $O((n+m)\log^2 n)$。
